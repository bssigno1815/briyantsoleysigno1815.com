<script>
(function(){
  const banner = document.getElementById('voiceBanner');
  if(!banner) return;

  // Ranmase chemen yo depi data-atribit
  const AUDIO_SRC = banner.dataset.audio || "/assets/audio/istwa-vwa.mp3";
  const VIDEO_SRC = banner.dataset.video || "/assets/video/istwa-vwa.mp4";

  // Prepare Audio
  const audio = new Audio(AUDIO_SRC);
  audio.preload = "auto";

  const playBtn = document.getElementById('voicePlay');
  const watchBtn = document.getElementById('voiceWatch');
  const dialog = document.getElementById('videoDialog');
  const video = document.getElementById('voiceVideo');

  let playing = false;
  function updatePlayBtn(){
    playBtn.setAttribute('aria-pressed', playing ? 'true' : 'false');
    playBtn.textContent = playing ? '‚è∏Ô∏é Pauze Vwa' : '‚ñ∂Ô∏é Jwe Vwa';
  }

  // Tcheke egzistans fichye yo pou pa montre bouton ki pa mache
  Promise.allSettled([
    fetch(AUDIO_SRC, { method: 'HEAD' }),
    fetch(VIDEO_SRC, { method: 'HEAD' })
  ]).then(([a,v])=>{
    if(!(a.value && a.value.ok)) playBtn.style.display = 'none';
    if(!(v.value && v.value.ok)) watchBtn.style.display = 'none';
  }).catch(()=>{ /* ign√≤re */ });

  // Bouton Jwe/Pauze vwa
  playBtn.addEventListener('click', async ()=>{
    try{
      if(!playing){
        await audio.play();
        playing = true;
      }else{
        audio.pause();
        playing = false;
      }
      updatePlayBtn();
    }catch(e){
      alert("Navigat√® a bloke autoplay. Peze bouton an ank√≤ oswa p√®m√®t son.");
    }
  });
  audio.addEventListener('ended', ()=>{ playing=false; updatePlayBtn(); });

  // Bouton Gade videyo
  watchBtn.addEventListener('click', ()=>{
    video.src = VIDEO_SRC;
    if(typeof dialog.showModal === 'function'){
      dialog.showModal();
    }else{
      // fallback si <dialog> pa sip√≤te
      window.open(VIDEO_SRC, '_blank');
    }
  });
})();
</script><!-- üîî ADMIN SMS: kole bl√≤k sa a anvan </body> -->
<button type="button" onclick="sendTest()"
  style="margin:16px 0;padding:10px 16px;border-radius:10px;border:1px solid #ffb000;background:#ffb000;color:#111;font-weight:700;cursor:pointer">
  üîî Voye SMS Test bay Admin
</button>

<script>
  // Voye done tranzaksyon bay API Vercel la
  async function notifyAdmin(data = {}) {
    try {
      const res = await fetch('/api/notify-transaction', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          amount: data.amount || 0,
          customerName: data.customerName || 'Unknown',
          method: data.method || 'card',
          txId: data.txId || ('TX-' + Date.now())
        })
      });

      const json = await res.json().catch(() => ({}));
      if (!res.ok) throw new Error(json.error || 'Request failed');
      console.log('Admin notified ‚úÖ', json);
    } catch (err) {
      console.error('SMS failed:', err);
      alert('Pa reyisi voye SMS admin. Tcheke Vercel logs.');
    }
  }

  // Bouton test pou verifye SMS la rive
  function sendTest() {
    notifyAdmin({
      amount: 100,
      customerName: 'Test User',
      method: 'test',
      txId: 'TEST-' + Math.floor(Math.random() * 1e6)
    });
  }
            </script><section class="card">
  <h2>Sekirite sou Badge Ti Machann yo</h2>
  <p><strong>Ti Machann</strong> yo se poto mitan sist√®m nou an. Chak badge gen yon nimewo inik ak enf√≤masyon kle ki idantifye machann nan.</p>
  
  <ul>
    <li>Tout done ki antre nan sist√®m badge yo estoke ak pwoteksyon <strong>kriptografi</strong>.</li>
    <li>Se s√®lman <strong>Admin otorize</strong> ki gen aks√® pou verifye oswa modifye badge yo.</li>
    <li>Nou voye <strong>notifikasyon otomatik</strong> bay Ti Machann l√® gen chanjman oswa tranzaksyon ki f√®t sou non yo.</li>
    <li>Badge yo gen <strong>k√≤d QR</strong> pou sekirite ak verifikasyon rapid.</li>
    <li>Tout itilizasyon badge yo anrejistre nan <em>dosye istorik</em> ki disponib pou kontw√≤l ent√®n.</li>
  </ul>

  <p class="muted">Sekirite badge ti machann yo enp√≤tan anpil paske li s√®vi k√≤m garanti transparans ak jistis nan Briyant Sol√®y Signo 1815.</p>
</section>
